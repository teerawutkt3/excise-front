<with-breadcrumb [breadcrumb]="breadcrumb">
  <segment header="รายละเอียดผลการประเมินความเสี่ยงแบบสอบถามระบบภายใน ปีงบประมาณ {{budgetYear}}" [loading]="loading"
    [right]="true">
    <div headRight>
      <app-button-custom color="gray" [text]="toggleButtonTxt" (click)="showModal2()">
      </app-button-custom>
    </div>
    <div *ngIf="showBody">
        <div class="ui form">
          <div class="inline fields" *ngIf="dataopen2">
              <div class="two wide field "></div>
              <div class="two wide field ">
                <label>อัตราความเสี่ยง  &nbsp; เท่ากับ &nbsp; {{datalist.verylowRating}}</label>
              </div>
              <div class="two wide field ">
                <label>ระดับความเสี่ยง &nbsp; &nbsp; {{datalist.verylow}}</label>
              </div>
              <div class="ten wide field ">
                  <label>{{infoUsedRiskDesc}} &nbsp; {{verylowthai}} &nbsp; {{datalist.verylowStart}} &nbsp; {{datalist.riskUnit}}</label>
                  <label *ngIf="verylowthai2 != 'ไม่ระบุ' " >และ &nbsp; {{verylowthai2}} &nbsp; {{datalist.verylowEnd}} &nbsp; {{datalist.riskUnit}}</label>
              </div>
            </div>

          <div class="inline fields">
              <div class="two wide field "></div>
              <div class="two wide field ">
                <label>อัตราความเสี่ยง  &nbsp; เท่ากับ &nbsp; {{datalist.lowRating}} </label>
              </div>
              <div class="two wide field ">
                <label>ระดับความเสี่ยง &nbsp; &nbsp; {{datalist.low}}</label>
              </div>
              <div class="ten wide field ">
                <label>{{infoUsedRiskDesc}} &nbsp; {{lowthai}} &nbsp; {{datalist.lowStart}} &nbsp; {{datalist.riskUnit}}</label>
                <label *ngIf="lowthai2 != 'ไม่ระบุ' " >และ &nbsp; {{lowthai2}}  &nbsp; {{datalist.lowEnd}} &nbsp; {{datalist.riskUnit}}</label>
              </div>
            </div>

          <div class="inline fields">
            <div class="two wide field "></div>
            <div class="two wide field ">
              <label>อัตราความเสี่ยง  &nbsp; เท่ากับ &nbsp; {{datalist.mediumRating}}</label>
            </div>
            <div class="two wide field ">
              <label>ระดับความเสี่ยง &nbsp; &nbsp; {{datalist.medium}}</label>
            </div>
            <div class="ten wide field ">
              <label>{{infoUsedRiskDesc}} &nbsp; {{mediumthai}} &nbsp; {{datalist.mediumStart}} &nbsp; {{datalist.riskUnit}}</label>
              <label *ngIf="mediumthai2 != 'ไม่ระบุ' " >และ &nbsp; {{mediumthai2}} &nbsp; {{datalist.mediumEnd}} &nbsp; {{datalist.riskUnit}}</label>
            </div>
            </div>

          <div class="inline fields">
              <div class="two wide field "></div>
              <div class="two wide field ">
                <label>อัตราความเสี่ยง  &nbsp; เท่ากับ &nbsp; {{datalist.highRating}}</label>
              </div>
              <div class="two wide field ">
                <label>ระดับความเสี่ยง &nbsp; &nbsp; {{datalist.high}}</label>
              </div>
              <div class="ten wide field ">
                <label>{{infoUsedRiskDesc}} &nbsp; {{highthai}} &nbsp; {{datalist.highStart}} &nbsp; {{datalist.riskUnit}}</label>
                <label *ngIf="highthai2 != 'ไม่ระบุ' " >และ &nbsp; {{highthai2}} &nbsp; {{datalist.highEnd}} &nbsp; {{datalist.riskUnit}}</label>
              </div>
            </div>

          <div class="inline fields" *ngIf="dataopen2">
              <div class="two wide field "></div>
              <div class="two wide field ">
                <label>อัตราความเสี่ยง  &nbsp; เท่ากับ &nbsp; {{datalist.veryhighRating}}</label>
              </div>
              <div class="two wide field ">
                <label>ระดับความเสี่ยง &nbsp; &nbsp; {{datalist.veryhigh}}</label>
              </div>
              <div class="ten wide field ">
                <label>{{infoUsedRiskDesc}} &nbsp; {{veryhighthai}} &nbsp; {{datalist.veryhighStart}} &nbsp; {{datalist.riskUnit}}</label>
                <label  *ngIf="veryhighthai2 != 'ไม่ระบุ' " >{{veryhighthai2}} &nbsp; {{datalist.veryhighEnd}} &nbsp; {{datalist.riskUnit}}</label>
              </div>
            </div>
          </div>
      </div>
    <div class="ui form">
      <div class="inline fields">
        <div class="five wide field">
          <label>ปัจจัยเสี่ยง : {{riskFactors}}</label>
        </div>
        <div field [col]="3">
          <select class="ui dropdown ai" id="secter" name="secterName" (change)="getList()"
            [formControl]="dropdownSector">
            <option value="all">ทั้งหมด</option>
            <option *ngFor="let item of dropdownSectors" [value]="item.officeCode">
              {{item.deptName}}
            </option>
          </select>
        </div>
      </div>
      <!-- <div class="inline fields">
        <div class="nine wide field">
          <label>ข้อมูลที่ใช้ประเมินความเสี่ยง : {{infoUsedRiskDesc}}</label>
        </div>
      </div> -->
    </div>
    <div form>
      <!-- <div inline>
        <div field [col]="16">
          <strong>
            <label>จำนวนทั้งหมด : </label>{{ summary.listQuantity }} ราย
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <label>ตอบแบบสอบถามไปแล้ว : </label>{{ summary.finishQuantity }} ราย
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <label>ยังไม่ตอบแบบสอบถาม : </label>{{ summary.draftQuantity }} ราย
          </strong>
        </div>
      </div> -->
      <div class="inline fields">
        <div class="field scrollAll" id="scroll" style="max-height: calc(100vh - 240px);">
          <table id="table" class="ui small collapsing celled table aligned">
            <thead>
              <tr class="text-center">
                <th rowspan="3" style="text-align: center !important ; width: 180px;">ลำดับที่
                </th>
                <th rowspan="3">สำนัก / สำนักงานสรรพสามิตภาค</th>
                <th rowspan="3">ฝ่าย / ส่วน / สำนักงานสรรพสามิตพื้นที่</th>
                <!-- <th rowspan="3" style="text-align: center !important ; width: 180px;">
                  จำนวนด้านความเสี่ยง</th> -->
                <th [attr.colspan]="headers.length > 0 ? headers.length*3 : 1">ด้าน ( จำนวน {{headers.length}} ด้าน )</th>
                <!-- <th rowspan="3" style="text-align: center !important ; width: 180px;">ส่งเมื่อ
                </th> -->
                <th rowspan="3" style="text-align: center !important ; width: 180px;">
                  ไม่มี/ไม่ใช่ (%)
                </th>
                <th rowspan="3" style="text-align: center !important ; width: 180px;">
                  อัตราความเสี่ยง
                </th>
                <th rowspan="3" style="text-align: center !important ; width: 180px;">
                  แปลงค่าความเสี่ยง</th>
              </tr>
              <tr class="text-center">
                <th colspan="3" *ngFor="let header of headers; let i = index">{{ header.name }}
                </th>
              </tr>
              <tr>
                <ng-container *ngFor="let header of headers; let i = index">
                  <th style="text-align: center !important ; width: 180px;">มี/ใช่</th>
                  <th style="text-align: center !important ; width: 180px;">ไม่มี/ไม่ใช่</th>
                  <th style="text-align: center !important ; width: 180px;">ระดับความเสี่ยง
                  </th>
                </ng-container>
              </tr>
            </thead>
            <tbody>
              <tr *ngIf="details.length == 0">
                <td [attr.colspan]="(headers.length > 0 ? headers.length*3 : 1)+8">
                  ไม่พบข้อมูล
                </td>
              </tr>
              <ng-container *ngFor="let detail of details; let i = index">
                <tr *ngIf="detail.status == '3'">
                  <td>{{ i+1 }}</td>
                  <td>{{ detail["exciseDepartmentVo"]?.sector | isEmpty }}</td>
                  <td>{{ detail["exciseDepartmentVo"]?.area | isEmpty }}</td>
                  <!-- <td class="text-right" >{{ detail.riskQuantity | isEmpty }}</td> -->
                  <ng-container *ngFor="let sideDtl of detail.sideDtls; let j =index">
                    <td class="text-right">{{ sideDtl.acceptValue | isEmpty }}</td>
                    <td class="text-right" >{{ sideDtl.declineValue | isEmpty }}</td>
                    <td class="text-center" [ngStyle]="{'background-color': sideDtl.intCalculateCriteriaVo.codeColor}">
                      {{ sideDtl.intCalculateCriteriaVo.translatingRisk }}</td>
                  </ng-container>
                  <!-- <td>
                    <span
                      *ngIf="detail.status == '3'">{{ detail.sentDate ? (detail.sentDate | dateString) : '-' }}</span>
                    <span *ngIf="detail.status != '3'">-</span>
                  </td> -->
                  <td class="text-right">{{ detail.avgRisk | decimalFormat:"###,###.00" }}</td>
                  <td class="text-center" >{{ detail.riskNum | isEmpty }}</td>
                  <td class="text-center" [ngStyle]="{'background-color': detail.intCalculateCriteriaVo.codeColor}">
                    {{detail.intCalculateCriteriaVo.translatingRisk}}</td>
                </tr>
                <tr *ngIf="detail.status != '3'">
                  <td>{{ i+1 }}</td>
                  <td>{{ detail["exciseDepartmentVo"]?.sector | isEmpty }}</td>
                  <td>{{ detail["exciseDepartmentVo"]?.area | isEmpty }}</td>
                  <td>{{ detail.riskQuantity | isEmpty }}</td>
                  <ng-container *ngFor="let sideDtl of detail.sideDtls; let j =index">
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                  </ng-container>
                  <td>-</td>
                  <td>-</td>
                  <td>-</td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>
      </div>
      <div class="inline center-all fields">
        <div class="field">
          <app-button-export (click)="showModal1()"></app-button-export>
          <app-button-back routerLink="/int03/04"></app-button-back>
          <!-- <app-button-back (click)="back()"></app-button-back> -->
        </div>
      </div>
    </div>
  </segment>
</with-breadcrumb>

<ui-modal [id]="'modal1'" [type]="'custom'">
  <div class="ui header">
    รายละเอียดหัวกระดาษทำการ
  </div>
  <div class="content">
    <div class="ui form">
      <form [formGroup]="dataExport">
        <div class="inline fields">
          <div class="three wide field required">
            <label class="text-right full-width">ชื่อกระดาษทำการ</label>
          </div>
          <div class="eight wide field ">
            <input class="custom ng-untouched ng-pristine ng-valid" id="riskHrdPaperName" maxlength="100"
              name="riskHrdPaperName" placeholder="ชื่อกระดาษทำการ" type="text" formControlName="riskHrdPaperName">
          </div>
          <div class="two wide field required">
            <label class="text-right full-width">ปีงบประมาณ</label>
          </div>
          <div class="four wide field ">
            <input class="custom ng-untouched ng-pristine" disabled="" id="budgetYear" name="budgetYear"
              placeholder="ปีงบประมาณ" type="text" formControlName="budgetYear">
          </div>
        </div>
        <div class="inline fields">
          <div class="three wide field required">
            <label class="text-right full-width">ผู้จัดทำ : ชื่อ </label>
          </div>

          <div class="three wide field ">
            <input class="custom ng-untouched ng-pristine ng-valid" id="createUserName" name="createUserName"
              placeholder="ชื่อผู้จัดทำ" type="text" formControlName="createUserName">
          </div>
          <div class="two wide field required">
            <label class="text-right full-width">นามสกุล</label>
          </div>
          <div class="three wide field ">
            <input class="custom ng-untouched ng-pristine ng-valid" id="createLastName" name="createLastName"
              placeholder="นามสกุล" type="text" formControlName="createLastName">
          </div>
          <div class="two wide field required">
            <label class="text-right full-width">ตำแหน่ง</label>
          </div>
          <div class="four wide field ">
            <input class="custom ng-untouched ng-pristine ng-valid" id="createPosition" name="createPosition"
              placeholder="ตำแหน่ง" type="text" formControlName="createPosition">
          </div>
        </div>
        <div class="inline fields">
          <div class="three wide field required">
            <label class="text-right full-width">ผู้ตรวจ : ชื่อ </label>
          </div>
          <div class="three wide field ">
            <input class="custom ng-untouched ng-pristine ng-valid" id="checkUserName" name="checkUserName"
              placeholder="ชื่อผู้ตรวจ" type="text" formControlName="checkUserName">
          </div>
          <div class="two wide field required">
            <label class="text-right full-width">นามสกุล</label>
          </div>
          <div class="three wide field ">
            <input class="custom ng-untouched ng-pristine ng-valid" id="checkLastName" name="checkLastName"
              placeholder="นามสกุล" type="text" formControlName="checkLastName">
          </div>
          <div class="two wide field required">
            <label class="text-right full-width">ตำแหน่ง</label>
          </div>
          <div class="four wide field ">
            <input class="custom ng-untouched ng-pristine" id="checkPosition" name="checkPosition" placeholder="ตำแหน่ง"
              type="text" formControlName="checkPosition">
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="actions ">
    <div class="ui center aligned grid">
      <div class="sixteen wide column">
        <!-- <button class="ui mini primary button" type="submit" ><i class="save icon"></i>บันทึก</button> -->
        <app-button-save class="positive" (click)="export()"></app-button-save>
        <app-button-cancel class="negative"></app-button-cancel>
      </div>
    </div>
  </div>
</ui-modal>
